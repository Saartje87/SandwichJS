/*!
 * SandwichJS v0.0.1
 * https://github.com/Saartje87/SandwichJS
 *
 * Copyright 2013 Niek Saarberg
 * Licensed MIT
 *
 * Build date 2013-12-04 20:25
 */
!function(a,b,c){this[a]=c(b)}("Sandwich",this,function(){"use strict";var a={};a.Error={report:function(a){throw new Error(a)}};var b={};a.Module={define:function(c,d,e){e||(e=d,d=null),"string"!=typeof c&&a.Error.report("Sandwich.Module.define::moduleName must be a string"),"function"!=typeof e&&a.Error.report("Sandwich.Module.define::module declaration must be an object"),b[c]={dependecies:d,module:e,instance:null}},start:function(c){var d,e=[];return c in b||a.Error.report("Sandwich.Module.start::module `"+c+"` not found"),d=b[c],d.instance?d.instance:(d.dependecies&&d.dependecies.forEach(function(b){e.push(a.Module.start(b))}),d.instance=d.module.apply(null,e))},getModules:function(){return b}};var c=!1;return a.Application={rootElement:"body",_modules:{},create:function(){var b,d=a.Application,e=d._modules,f={};if(c)return a.Error.report("Sandwich.Application.create already initialized");f.rootElement=PB.$(d.rootElement);for(b in e)e.hasOwnProperty(b)&&(f[b]=e[b]());return c=!0,f},register:function(a,b){this._modules[a]=b}},a.Module.define("Router",["Route"],function(b){function c(a){var b;"string"!=typeof a&&(a=window.location.hash),a=d(a),(b=e(a))&&b.callback.apply(b.callback,b.params)}function d(a){return a.replace(/^#?\!?/,"").replace(/^\/\/+/g,"/").replace(/^[\/|\s]+|[\/|\s]+$/g,"")}function e(a){for(var c,d,e=b.all(),f=0;f<e.length;f++)if(c=e[f].matches(a)){d=e[f];break}return d?{route:d.route,callback:d.callback,params:c}:!1}if(!("onhashchange"in window))throw new Error("Browser not supported");return PB.$(window).on("hashchange",c),PB.ready(c),{navigate:function(a,b){return a=a.replace(window.location.protocol+"//"+window.location.hostname,""),b&&b.silent?c(a,b):(window.location.hash="!"+d(a),void 0)},when:function(c,e){"string"!=typeof c&&a.Error.report("Router.when::First argument must be a string"),"function"!=typeof e&&a.Error.report("Router.when::Second argument must be a function"),c=d(c),b.add(c,e)}}}),a.Application.register("Router",function(){return a.Module.start("Router")}),a.Module.define("Route",function(){function a(a){for(var b="^",c="",d=0,e=a.length;e>d;d++)switch(c=a[d]){case"/":b+="\\/";break;case":":d=skipGroup(d,a),b+="([a-z0-9.\\s_-]+)";break;case"*":d=skipGroup(d,a),b+="(.*)";break;default:b+=c}return b+="$",b=new RegExp(b,"i"),function(a){var c=a.match(b);return c?Array.prototype.slice.call(c,1):null}}var b=[];return{add:function(c,d){b.unshift({route:c,matches:a(c),callback:d})},all:function(){return b}}}),a});