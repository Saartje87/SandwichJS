/*!
 * SandwichJS v0.0.1
 * https://github.com/Saartje87/SandwichJS
 *
 * Copyright 2013 Niek Saarberg
 * Licensed MIT
 *
 * Build date 2013-12-04 18:01
 */
!function(a,b,c){this[a]=c(b)}("Sandwich",this,function(){"use strict";var a={},b=!1;return a.Application={rootElement:"body",_modules:{},create:function(){var c,d=a.Application,e=d._modules,f={};if(b)return a.Error.report("Sandwich.Application.create already initialized");f.rootElement=PB.$(d.rootElement);for(c in e)e.hasOwnProperty(c)&&(f[c]=e[c]());return b=!0,f},define:function(b,c){a.Application._modules[b]=c}},a.Error={report:function(a){throw new Error(a)}},a.Application.define("Router",function(){function b(a){var b;"string"!=typeof a&&(a=window.location.hash),a=c(a),(b=d(a))&&b.callback.apply(b.callback,b.params)}function c(a){return a.replace(/^#?\!?/,"").replace(/^\/\/+/g,"/").replace(/^[\/|\s]+|[\/|\s]+$/g,"")}function d(a){for(var b,c={},d=0;d<e.length;d++)if(c=e[d].matches(a)){b=e[d];break}return b?{route:b.route,callback:b.callback,params:c}:!1}var e=[];if(!("onhashchange"in window))throw new Error("Browser not supported");PB.$(window).on("hashchange",b),PB.ready(b);var f={compile:function(a){for(var b="^",c="",d=0,e=a.length;e>d;d++)switch(c=a[d]){case"/":b+="\\/";break;case":":d=f.skipGroup(d,a),b+="([a-z0-9.\\s_-]+)";break;case"*":d=f.skipGroup(d,a),b+="(.*)";break;default:b+=c}return b+="$",b=new RegExp(b,"i"),function(a){var c=a.match(b);return c?Array.prototype.slice.call(c,1):null}},skipGroup:function(a,b){for(a+=1;a<b.length;a++)if(!/[a-zA-Z0-9]/.test(b[a]))return a-1;return a}};return{navigate:function(a,d){return a=a.replace(window.location.protocol+"//"+window.location.hostname,""),d&&d.silent?b(a,d):(window.location.hash="!"+c(a),void 0)},when:function(b,d){"string"!=typeof b&&a.Error.report("Router.when::First argument must be a string"),"function"!=typeof d&&a.Error.report("Router.when::Second argument must be a function"),b=c(b),e.unshift({route:b,matches:f.compile(b),callback:d})}}}),a});